var Gt=Object.defineProperty,Rt=(t,e,i)=>e in t?Gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,B=(t,e,i)=>(Rt(t,typeof e!="symbol"?e+"":e,i),i),ct=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},n=(t,e,i)=>(ct(t,e,"read from private field"),i?i.call(t):e.get(t)),r=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},h=(t,e,i,s)=>(ct(t,e,"write to private field"),s?s.call(t,i):e.set(t,i),i),l=(t,e,i)=>(ct(t,e,"access private method"),i),J,f,g,_,I,p,k,N,y,H,S,$,q,T,M,w,it,Mt,nt,Wt,st,Et,ot,bt,lt,Nt,dt,yt,ut,Ht,L,K,P,A,D,F,C,b,ft,Tt,mt,Pt,Q,gt,rt,Dt,U,pt,v,x,Y,W,G,wt,d,ht,Lt,R,_t,vt,Ot,V,at;const z=500,At={time:300,distance:20,duration:2e3,deceleration:.002},tt={duration:300},et={speed:20,discreteTime:400},zt={selectedIndexes:[],usePointerEvents:!1,scrollShape:"scale",moveThreshold:20,momentum:At,itemClassName:"mobile-picker-view-item",clickToSelect:!1,mouseWheel:!1};function X(t){return typeof window!="undefined"&&window.navigator?!!navigator.userAgent.match(t):!1}const Jt=X(/safari/i)&&!X(/chrome/i)&&!X(/android/i),Kt=X(/iP(ad|od|hone)/i),St="picker-drag-start",Ft="picker-dragging";function E(t,e,i){return Math.min(Math.max(t,e),i)}function Qt(t,e){return E(t||0,0,e)}function Z(t,e,i){return t>i||t<e}function Ut(t,e,i,s){const o=t-e,a=Math.abs(o)/i,{deceleration:u}=s,c=a/u*(o<0?-1:1);return Math.round(c)}const Zt=15,jt=.1;function te(t){if(!!(t!=null&&t.length))for(let e=0;e<t.length;e++){const i=t[e];i.style.transform="none"}}function ee(t,e,i){if(!!(i!=null&&i.length))for(let s=0;s<i.length;s++){const o=i[s],a=E(1-jt*Math.abs(t/e+s),.5,1);o.style.transform=`scale(${a.toFixed(2)})`}}function ie(t,e,i){if(!!(i!=null&&i.length))for(let s=0;s<i.length;s++){const o=i[s],a=Zt*(t/e+s);o.style.transform=`rotateX(${a.toFixed(0)}deg)`}}const Yt={flat:null,scale:ee,rotate:ie};function Ct(t){if(t.length===0)return;const e=t.item(0);if(!!e)return{clientX:e.clientX,clientY:e.clientY}}const It=t=>{if("clientX"in t&&"clientY"in t)return{clientX:t.clientX,clientY:t.clientY};if("touches"in t){const e=Ct(t.touches);if(e)return e}if("changedTouches"in t){const e=Ct(t.changedTouches);if(e)return e}},ne=t=>typeof t=="function";function se(t,e){let i=null;for(;t&&!i;)(t==null?void 0:t.matches)&&t.matches(e)&&(i=t),t=t.parentNode;return i}function oe(t,e){let i=0;if(!t||!t.parentNode)return-1;let s=t.previousElementSibling;for(;s;)(!e||s.matches(e))&&i++,s=s.previousElementSibling;return i}class le{constructor(e,i){r(this,it),r(this,nt),r(this,st),r(this,ot),r(this,lt),r(this,dt),r(this,ut),r(this,L),r(this,P),r(this,D),r(this,C),r(this,ft),r(this,mt),r(this,Q),r(this,rt),r(this,U),r(this,v),r(this,Y),r(this,G),r(this,J,!1),r(this,f,0),r(this,g,null),B(this,"metaInfo",{listContainerHeight:0,itemHeight:0,minScrollY:0,maxScrollY:0,limitMinScrollY:0,limitMaxScrollY:0}),r(this,_,null),r(this,I,null),r(this,p,null),r(this,k,null),r(this,N,null),r(this,y,null),r(this,H,void 0),r(this,S,void 0),B(this,"innerSelectedIndex",0),r(this,$,0),r(this,q,void 0),r(this,T,void 0),r(this,M,null),r(this,w,""),this.rootNode=e,this.options=i,h(this,H,i.usePointerEvents?"PointerEvent"in window&&(!Jt||Kt):!1),h(this,S,i.momentum===!1?!1:{...At,...i.momentum}),h(this,q,l(this,it,Mt).call(this,i.clickToSelect)),h(this,T,l(this,nt,Wt).call(this,i.mouseWheel)),l(this,ot,bt).call(this),l(this,lt,Nt).call(this),h(this,w,"init"),this.setIndex(this.options.selectedIndex);const{items:s,itemHeight:o}=this.metaInfo;s&&(h(this,M,l(this,st,Et).call(this,i.scrollShape,s)),n(this,M)?n(this,M).call(this,n(this,f),o,s):te(s))}setIndex(e,i=0){var s;if(!((s=this.metaInfo.items)!=null&&s.length))return this.innerSelectedIndex;h(this,w,n(this,w)||"api");const o=Qt(e,this.metaInfo.items.length-1);if(this.innerSelectedIndex!==o){l(this,v,x).call(this,i);const a=l(this,rt,Dt).call(this,o);l(this,Y,W).call(this,a),l(this,L,K).call(this,o)}return o}destroy(){var e,i,s;l(this,G,wt).call(this),(e=n(this,k))==null||e.abort(),h(this,k,null),(i=n(this,N))==null||i.abort(),h(this,N,null),(s=n(this,y))==null||s.abort(),h(this,y,null),h(this,w,"")}}J=new WeakMap;f=new WeakMap;g=new WeakMap;_=new WeakMap;I=new WeakMap;p=new WeakMap;k=new WeakMap;N=new WeakMap;y=new WeakMap;H=new WeakMap;S=new WeakMap;$=new WeakMap;q=new WeakMap;T=new WeakMap;M=new WeakMap;w=new WeakMap;it=new WeakSet;Mt=function(t){return t?t===!0?{...tt,enable:!0}:{...tt,...t,enable:!0}:{...tt,enable:!1}};nt=new WeakSet;Wt=function(t){return t?t===!0?{...et,enable:!0}:{...et,...t,enable:!0}:{...et,enable:!1}};st=new WeakSet;Et=function(t,e){let i=Yt.flat;return(e==null?void 0:e.length)>3&&(i=ne(t)?t:Yt[t]),i};ot=new WeakSet;bt=function(){const t=this.rootNode.firstElementChild,e=t==null?void 0:t.firstElementChild;if(n(this,J)||!e)return;const i=0,s=-t.offsetHeight+e.offsetHeight;this.metaInfo={itemContainer:t,items:t.children,listContainerHeight:t.offsetHeight,itemHeight:e.offsetHeight,maxScrollY:i,minScrollY:s,limitMinScrollY:s-this.options.moveThreshold,limitMaxScrollY:i+this.options.moveThreshold}};lt=new WeakSet;Nt=function(){var t,e,i,s,o;h(this,k,new AbortController),n(this,H)?this.rootNode.addEventListener("pointerdown",l(this,P,A).bind(this),{signal:(t=n(this,k))==null?void 0:t.signal}):(this.rootNode.addEventListener("touchstart",l(this,P,A).bind(this),{signal:(e=n(this,k))==null?void 0:e.signal}),this.rootNode.addEventListener("mousedown",l(this,P,A).bind(this),{signal:(i=n(this,k))==null?void 0:i.signal})),h(this,N,new AbortController),this.metaInfo.itemContainer.addEventListener("transitionend",l(this,ft,Tt).bind(this),{signal:(s=n(this,N))==null?void 0:s.signal});const{enable:a,duration:u}=n(this,q);if(a){const{itemClassName:c}=this.options;this.rootNode.addEventListener("click",m=>{const O=se(m.target,"."+c);if(O){const j=oe(O,"."+c);h(this,w,"click"),this.setIndex(j,u)}})}n(this,T).enable&&(h(this,y,new AbortController),this.rootNode.addEventListener("wheel",c=>{c.preventDefault(),c.stopPropagation(),l(this,dt,yt).call(this,c)},{signal:(o=n(this,y))==null?void 0:o.signal}))};dt=new WeakSet;yt=function(t){const{deltaY:e,deltaMode:i}=t;let s=0;i===1?s=-e*n(this,T).speed:s=-e;const{limitMinScrollY:o,limitMaxScrollY:a,minScrollY:u,maxScrollY:c}=this.metaInfo;let m=n(this,f)+s;Z(m,u,c)&&(m=E(n(this,f)+s/3,o,a)),l(this,v,x).call(this,300),l(this,Y,W).call(this,m),l(this,ut,Ht).call(this)};ut=new WeakSet;Ht=function(){window.clearTimeout(n(this,$)),h(this,$,window.setTimeout(()=>{const{index:t,y:e}=l(this,Q,gt).call(this,n(this,f)),{limitMinScrollY:i,limitMaxScrollY:s}=this.metaInfo,o=E(e,i,s);l(this,v,x).call(this,z),l(this,Y,W).call(this,o),h(this,w,"wheel"),l(this,L,K).call(this,t)},n(this,T).discreteTime))};L=new WeakSet;K=function(t){l(this,mt,Pt).call(this,t),this.options.onChange(t,n(this,w))};P=new WeakSet;A=function(t){const e=It(t);if(n(this,_)||!e)return;l(this,v,x).call(this),this.rootNode.classList.add(St),h(this,_,{time:Date.now(),startY:e.clientY,pointY:e.clientY});const i=t.target;h(this,g,i.ownerDocument),h(this,I,new AbortController),h(this,p,new AbortController),n(this,H)?(this.rootNode.setPointerCapture(t.pointerId),n(this,g).addEventListener("pointermove",l(this,D,F).bind(this),{signal:n(this,I).signal}),n(this,g).addEventListener("pointerup",l(this,C,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("pointercancel",l(this,C,b).bind(this),{signal:n(this,p).signal})):(n(this,g).addEventListener("mousemove",l(this,D,F).bind(this),{signal:n(this,I).signal}),n(this,g).addEventListener("touchmove",l(this,D,F).bind(this),{signal:n(this,I).signal}),n(this,g).addEventListener("mouseup",l(this,C,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("touchend",l(this,C,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("touchcancel",l(this,C,b).bind(this),{signal:n(this,p).signal}))};D=new WeakSet;F=function(t){const e=It(t);if(!this.rootNode||!n(this,_)||!e)return;this.rootNode.classList.remove(St),this.rootNode.classList.add(Ft);const{pointY:i}=n(this,_),s=e.clientY-i;n(this,_).pointY=e.clientY;const{minScrollY:o,maxScrollY:a,limitMinScrollY:u,limitMaxScrollY:c}=this.metaInfo;let m=n(this,f)+s;Z(m,o,a)&&(m=E(n(this,f)+s/3,u,c)),l(this,Y,W).call(this,m)};C=new WeakSet;b=function(t){if(!this.rootNode||!n(this,_))return;n(this,H)&&this.rootNode.releasePointerCapture(t.pointerId);let e=0,i=z,s=n(this,f);const{limitMinScrollY:o,limitMaxScrollY:a,minScrollY:u,maxScrollY:c}=this.metaInfo,m=l(this,U,pt).call(this);if(m)s=m;else{const Vt=It(t),{time:Xt,startY:kt,pointY:Bt}=n(this,_),xt=Date.now()-Xt,$t=Math.abs(Math.round(Vt.clientY)-kt);if(n(this,S)&&xt<n(this,S).time&&$t>n(this,S).distance){const qt=Ut(Bt,kt,xt,n(this,S));i=n(this,S).duration,s=n(this,f)+qt,Z(s,u,c)&&(i=z)}}const{index:O,y:j}=l(this,Q,gt).call(this,s);s=j,e=O,s!==n(this,f)&&(h(this,w,"drag"),s=E(s,o,a),l(this,v,x).call(this,i),l(this,Y,W).call(this,s),l(this,L,K).call(this,e)),l(this,G,wt).call(this)};ft=new WeakSet;Tt=function(){const t=l(this,U,pt).call(this);t===null?l(this,v,x).call(this):(l(this,v,x).call(this,z),l(this,Y,W).call(this,t))};mt=new WeakSet;Pt=function(t){this.innerSelectedIndex=t};Q=new WeakSet;gt=function(t){var e;if(!((e=this.metaInfo.items)!=null&&e.length))return{index:-1,y:0};const{itemHeight:i,items:s}=this.metaInfo;let o=-1,a=0;const u=Math.min(0,t);return o=E(Math.round(Math.abs(u)/i),0,s.length-1),a=o*i*(u/(Math.abs(u)||1)),{index:o,y:a}};rt=new WeakSet;Dt=function(t){var e;if(!((e=this.metaInfo.items)!=null&&e.length))return 0;const{itemHeight:i}=this.metaInfo;return-t*i};U=new WeakSet;pt=function(){let t=null;const{minScrollY:e,maxScrollY:i}=this.metaInfo;return Z(n(this,f),e,i)&&(t=n(this,f)>i?i:e),t};v=new WeakSet;x=function(t=0){h(this,J,t>0),this.rootNode.style.setProperty("--picker-transit-duration",`${t}ms`)};Y=new WeakSet;W=function(t){if(!this.rootNode||n(this,f)===t)return;this.rootNode.style.setProperty("--picker-transit-y",`${t}px`),h(this,f,t);const{items:e,itemHeight:i}=this.metaInfo;n(this,M)&&n(this,M).call(this,t,i,e)};G=new WeakSet;wt=function(){var t,e;console.log("cleanup"),this.rootNode.classList.remove(St),this.rootNode.classList.remove(Ft),h(this,_,null),(t=n(this,I))==null||t.abort(),h(this,I,null),(e=n(this,p))==null||e.abort(),h(this,p,null)};class he{constructor(e,i){if(r(this,ht),r(this,R),r(this,vt),r(this,V),B(this,"rootNode"),B(this,"innerOptions"),r(this,d,[]),this.rootNode=typeof e=="string"?document.querySelector(e):e,!this.rootNode)throw new Error("root node not found");this.innerOptions={...zt,...i},l(this,ht,Lt).call(this)}setIndexes(e){this.innerOptions.selectedIndexes=e;const i=[];return e.forEach((s,o)=>{n(this,d)[o]&&i.push(n(this,d)[o].setIndex(s))}),i}refreshAll(e){const i=this.rootNode.querySelectorAll(".mobile-picker-view");return i.length?(this.innerOptions.selectedIndexes.length=i.length,n(this,d).forEach(s=>s.destroy()),n(this,d).length=i.length,this.refreshColumns(n(this,d).map((s,o)=>o),e)):l(this,V,at).call(this)}refreshColumns(e,i){const s=this.rootNode.querySelectorAll(".mobile-picker-view");return s.length?(e.forEach(o=>{const a=s[o];a&&n(this,d)[o]&&(n(this,d)[o].destroy(),n(this,d)[o]=l(this,R,_t).call(this,a,i||this.innerOptions.selectedIndexes,o))}),this.innerOptions.selectedIndexes=n(this,d).map(o=>o.innerSelectedIndex),this.innerOptions.selectedIndexes):l(this,V,at).call(this)}}d=new WeakMap;ht=new WeakSet;Lt=function(t){var e,i;const s=this.rootNode.querySelectorAll(".mobile-picker-view");this.innerOptions.selectedIndexes.length=s.length,s.forEach((a,u)=>{const c=l(this,R,_t).call(this,a,t||this.innerOptions.selectedIndexes,u);n(this,d).push(c)}),this.innerOptions.selectedIndexes=n(this,d).map(a=>a.innerSelectedIndex);const o=((i=(e=n(this,d)[0])==null?void 0:e.metaInfo)==null?void 0:i.itemHeight)||0;o>0&&this.rootNode.style.setProperty("--picker-item-height",`${o}px`)};R=new WeakSet;_t=function(t,e,i){return new le(t,{...this.innerOptions,selectedIndex:e[i],onChange:(o,a)=>{l(this,vt,Ot).call(this,o,a,i)}})};vt=new WeakSet;Ot=function(t,e,i){var s,o;this.innerOptions.selectedIndexes[i]=t,(o=(s=this.innerOptions).onChange)==null||o.call(s,this.innerOptions.selectedIndexes,e,i)};V=new WeakSet;at=function(){return this.innerOptions.selectedIndexes=[],n(this,d).forEach(t=>t.destroy()),h(this,d,[]),[]};export{he as P};
