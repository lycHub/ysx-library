var Rt=Object.defineProperty,zt=(t,e,i)=>e in t?Rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,B=(t,e,i)=>(zt(t,typeof e!="symbol"?e+"":e,i),i),ct=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},n=(t,e,i)=>(ct(t,e,"read from private field"),i?i.call(t):e.get(t)),r=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},h=(t,e,i,s)=>(ct(t,e,"write to private field"),s?s.call(t,i):e.set(t,i),i),o=(t,e,i)=>(ct(t,e,"access private method"),i),J,f,g,_,x,p,Y,N,y,H,k,$,q,T,W,w,it,Wt,nt,Et,st,bt,ot,Nt,lt,yt,dt,Ht,ut,Tt,L,K,P,A,D,F,M,b,ft,Pt,mt,Dt,Q,gt,rt,Lt,U,pt,v,I,S,C,G,wt,d,ht,Ot,R,_t,vt,At,V,at;const z=500,Ft={time:300,distance:20,duration:2e3,deceleration:.002},tt={duration:300},et={speed:20,discreteTime:400},Jt={selectedIndexes:[],usePointerEvents:!1,scrollShape:"scale",moveThreshold:20,momentum:Ft,itemClassName:"mobile-picker-view-item",clickToSelect:!1,mouseWheel:!1};function X(t){return typeof window!="undefined"&&window.navigator?!!navigator.userAgent.match(t):!1}const Kt=X(/safari/i)&&!X(/chrome/i)&&!X(/android/i),Qt=X(/iP(ad|od|hone)/i),St="picker-drag-start",Vt="picker-dragging";function E(t,e,i){return Math.min(Math.max(t,e),i)}function Ut(t,e){return E(t||0,0,e)}function Z(t,e,i){return t>i||t<e}function Zt(t,e,i,s){const l=t-e,a=Math.abs(l)/i,{deceleration:u}=s,c=a/u*(l<0?-1:1);return Math.round(c)}const jt=15,te=.1;function ee(t){if(!!(t!=null&&t.length))for(let e=0;e<t.length;e++){const i=t[e];i.style.transform="none"}}function ie(t,e,i){if(!!(i!=null&&i.length))for(let s=0;s<i.length;s++){const l=i[s],a=E(1-te*Math.abs(t/e+s),.5,1);l.style.transform=`scale(${a.toFixed(2)})`}}function ne(t,e,i){if(!!(i!=null&&i.length))for(let s=0;s<i.length;s++){const l=i[s],a=jt*(t/e+s);l.style.transform=`rotateX(${a.toFixed(0)}deg)`}}const Yt={flat:null,scale:ie,rotate:ne};function Ct(t){if(t.length===0)return;const e=t.item(0);if(!!e)return{clientX:e.clientX,clientY:e.clientY}}const It=t=>{if("clientX"in t&&"clientY"in t)return{clientX:t.clientX,clientY:t.clientY};if("touches"in t){const e=Ct(t.touches);if(e)return e}if("changedTouches"in t){const e=Ct(t.changedTouches);if(e)return e}},se=t=>typeof t=="function";function oe(t,e){let i=null;for(;t&&!i;)(t==null?void 0:t.matches)&&t.matches(e)&&(i=t),t=t.parentNode;return i}function le(t,e){let i=0;if(!t||!t.parentNode)return-1;let s=t.previousElementSibling;for(;s;)(!e||s.matches(e))&&i++,s=s.previousElementSibling;return i}const Mt={listContainerHeight:0,itemHeight:0,minScrollY:0,maxScrollY:0,limitMinScrollY:0,limitMaxScrollY:0};class re{constructor(e,i){r(this,it),r(this,nt),r(this,st),r(this,ot),r(this,lt),r(this,dt),r(this,ut),r(this,L),r(this,P),r(this,D),r(this,M),r(this,ft),r(this,mt),r(this,Q),r(this,rt),r(this,U),r(this,v),r(this,S),r(this,G),r(this,J,!1),r(this,f,0),r(this,g,null),B(this,"metaInfo",Mt),r(this,_,null),r(this,x,null),r(this,p,null),r(this,Y,null),r(this,N,null),r(this,y,null),r(this,H,void 0),r(this,k,void 0),B(this,"innerSelectedIndex",0),r(this,$,0),r(this,q,void 0),r(this,T,void 0),r(this,W,null),r(this,w,""),this.rootNode=e,this.options=i,h(this,H,i.usePointerEvents?"PointerEvent"in window&&(!Kt||Qt):!1),h(this,k,i.momentum===!1?!1:{...Ft,...i.momentum}),h(this,q,o(this,it,Wt).call(this,i.clickToSelect)),h(this,T,o(this,nt,Et).call(this,i.mouseWheel)),o(this,ot,Nt).call(this),o(this,lt,yt).call(this),h(this,w,"init"),this.setIndex(this.options.selectedIndex);const{items:s,itemHeight:l}=this.metaInfo;s&&(h(this,W,o(this,st,bt).call(this,i.scrollShape,s)),n(this,W)?n(this,W).call(this,n(this,f),l,s):ee(s))}setIndex(e,i=0){var s;if(!((s=this.metaInfo.items)!=null&&s.length))return this.innerSelectedIndex;h(this,w,n(this,w)||"api");const l=Ut(e,this.metaInfo.items.length-1);if(this.innerSelectedIndex!==l){o(this,v,I).call(this,i);const a=o(this,rt,Lt).call(this,l);o(this,S,C).call(this,a),o(this,L,K).call(this,l)}return l}destroy(){var e,i,s;o(this,G,wt).call(this),(e=n(this,Y))==null||e.abort(),h(this,Y,null),(i=n(this,N))==null||i.abort(),h(this,N,null),(s=n(this,y))==null||s.abort(),h(this,y,null),h(this,w,""),this.metaInfo=Mt,o(this,v,I).call(this),o(this,S,C).call(this,0)}}J=new WeakMap;f=new WeakMap;g=new WeakMap;_=new WeakMap;x=new WeakMap;p=new WeakMap;Y=new WeakMap;N=new WeakMap;y=new WeakMap;H=new WeakMap;k=new WeakMap;$=new WeakMap;q=new WeakMap;T=new WeakMap;W=new WeakMap;w=new WeakMap;it=new WeakSet;Wt=function(t){return t?t===!0?{...tt,enable:!0}:{...tt,...t,enable:!0}:{...tt,enable:!1}};nt=new WeakSet;Et=function(t){return t?t===!0?{...et,enable:!0}:{...et,...t,enable:!0}:{...et,enable:!1}};st=new WeakSet;bt=function(t,e){let i=Yt.flat;return(e==null?void 0:e.length)>3&&(i=se(t)?t:Yt[t]),i};ot=new WeakSet;Nt=function(){const t=this.rootNode.firstElementChild,e=t==null?void 0:t.firstElementChild;if(n(this,J)||!e)return;const i=0,s=-t.offsetHeight+e.offsetHeight;this.metaInfo={itemContainer:t,items:t.children,listContainerHeight:t.offsetHeight,itemHeight:e.offsetHeight,maxScrollY:i,minScrollY:s,limitMinScrollY:s-this.options.moveThreshold,limitMaxScrollY:i+this.options.moveThreshold}};lt=new WeakSet;yt=function(){var t,e,i,s,l;h(this,Y,new AbortController),n(this,H)?this.rootNode.addEventListener("pointerdown",o(this,P,A).bind(this),{signal:(t=n(this,Y))==null?void 0:t.signal}):(this.rootNode.addEventListener("touchstart",o(this,P,A).bind(this),{signal:(e=n(this,Y))==null?void 0:e.signal}),this.rootNode.addEventListener("mousedown",o(this,P,A).bind(this),{signal:(i=n(this,Y))==null?void 0:i.signal})),h(this,N,new AbortController),this.metaInfo.itemContainer.addEventListener("transitionend",o(this,ft,Pt).bind(this),{signal:(s=n(this,N))==null?void 0:s.signal});const{enable:a,duration:u}=n(this,q);if(a){const{itemClassName:c}=this.options;this.rootNode.addEventListener("click",m=>{const O=oe(m.target,"."+c);if(O){const j=le(O,"."+c);h(this,w,"click"),this.setIndex(j,u)}})}n(this,T).enable&&(h(this,y,new AbortController),this.rootNode.addEventListener("wheel",c=>{c.preventDefault(),c.stopPropagation(),o(this,dt,Ht).call(this,c)},{signal:(l=n(this,y))==null?void 0:l.signal}))};dt=new WeakSet;Ht=function(t){const{deltaY:e,deltaMode:i}=t;let s=0;i===1?s=-e*n(this,T).speed:s=-e;const{limitMinScrollY:l,limitMaxScrollY:a,minScrollY:u,maxScrollY:c}=this.metaInfo;let m=n(this,f)+s;Z(m,u,c)&&(m=E(n(this,f)+s/3,l,a)),o(this,v,I).call(this,300),o(this,S,C).call(this,m),o(this,ut,Tt).call(this)};ut=new WeakSet;Tt=function(){window.clearTimeout(n(this,$)),h(this,$,window.setTimeout(()=>{const{index:t,y:e}=o(this,Q,gt).call(this,n(this,f)),{limitMinScrollY:i,limitMaxScrollY:s}=this.metaInfo,l=E(e,i,s);o(this,v,I).call(this,z),o(this,S,C).call(this,l),h(this,w,"wheel"),o(this,L,K).call(this,t)},n(this,T).discreteTime))};L=new WeakSet;K=function(t){o(this,mt,Dt).call(this,t),this.options.onChange(t,n(this,w))};P=new WeakSet;A=function(t){const e=It(t);if(n(this,_)||!e)return;o(this,v,I).call(this),this.rootNode.classList.add(St),h(this,_,{time:Date.now(),startY:e.clientY,pointY:e.clientY});const i=t.target;h(this,g,i.ownerDocument),h(this,x,new AbortController),h(this,p,new AbortController),n(this,H)?(this.rootNode.setPointerCapture(t.pointerId),n(this,g).addEventListener("pointermove",o(this,D,F).bind(this),{signal:n(this,x).signal}),n(this,g).addEventListener("pointerup",o(this,M,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("pointercancel",o(this,M,b).bind(this),{signal:n(this,p).signal})):(n(this,g).addEventListener("mousemove",o(this,D,F).bind(this),{signal:n(this,x).signal}),n(this,g).addEventListener("touchmove",o(this,D,F).bind(this),{signal:n(this,x).signal}),n(this,g).addEventListener("mouseup",o(this,M,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("touchend",o(this,M,b).bind(this),{signal:n(this,p).signal}),n(this,g).addEventListener("touchcancel",o(this,M,b).bind(this),{signal:n(this,p).signal}))};D=new WeakSet;F=function(t){const e=It(t);if(!this.rootNode||!n(this,_)||!e)return;this.rootNode.classList.remove(St),this.rootNode.classList.add(Vt);const{pointY:i}=n(this,_),s=e.clientY-i;n(this,_).pointY=e.clientY;const{minScrollY:l,maxScrollY:a,limitMinScrollY:u,limitMaxScrollY:c}=this.metaInfo;let m=n(this,f)+s;Z(m,l,a)&&(m=E(n(this,f)+s/3,u,c)),o(this,S,C).call(this,m)};M=new WeakSet;b=function(t){if(!this.rootNode||!n(this,_))return;n(this,H)&&this.rootNode.releasePointerCapture(t.pointerId);let e=0,i=z,s=n(this,f);const{limitMinScrollY:l,limitMaxScrollY:a,minScrollY:u,maxScrollY:c}=this.metaInfo,m=o(this,U,pt).call(this);if(m)s=m;else{const Xt=It(t),{time:Bt,startY:kt,pointY:$t}=n(this,_),xt=Date.now()-Bt,qt=Math.abs(Math.round(Xt.clientY)-kt);if(n(this,k)&&xt<n(this,k).time&&qt>n(this,k).distance){const Gt=Zt($t,kt,xt,n(this,k));i=n(this,k).duration,s=n(this,f)+Gt,Z(s,u,c)&&(i=z)}}const{index:O,y:j}=o(this,Q,gt).call(this,s);s=j,e=O,s!==n(this,f)&&(h(this,w,"drag"),s=E(s,l,a),o(this,v,I).call(this,i),o(this,S,C).call(this,s),o(this,L,K).call(this,e)),o(this,G,wt).call(this)};ft=new WeakSet;Pt=function(){const t=o(this,U,pt).call(this);t===null?o(this,v,I).call(this):(o(this,v,I).call(this,z),o(this,S,C).call(this,t))};mt=new WeakSet;Dt=function(t){this.innerSelectedIndex=t};Q=new WeakSet;gt=function(t){var e;if(!((e=this.metaInfo.items)!=null&&e.length))return{index:-1,y:0};const{itemHeight:i,items:s}=this.metaInfo;let l=-1,a=0;const u=Math.min(0,t);return l=E(Math.round(Math.abs(u)/i),0,s.length-1),a=l*i*(u/(Math.abs(u)||1)),{index:l,y:a}};rt=new WeakSet;Lt=function(t){var e;if(!((e=this.metaInfo.items)!=null&&e.length))return 0;const{itemHeight:i}=this.metaInfo;return-t*i};U=new WeakSet;pt=function(){let t=null;const{minScrollY:e,maxScrollY:i}=this.metaInfo;return Z(n(this,f),e,i)&&(t=n(this,f)>i?i:e),t};v=new WeakSet;I=function(t=0){h(this,J,t>0),this.rootNode.style.setProperty("--picker-transit-duration",`${t}ms`)};S=new WeakSet;C=function(t){if(!this.rootNode||n(this,f)===t)return;this.rootNode.style.setProperty("--picker-transit-y",`${t}px`),h(this,f,t);const{items:e,itemHeight:i}=this.metaInfo;n(this,W)&&n(this,W).call(this,t,i,e)};G=new WeakSet;wt=function(){var t,e;this.rootNode.classList.remove(St),this.rootNode.classList.remove(Vt),h(this,_,null),(t=n(this,x))==null||t.abort(),h(this,x,null),(e=n(this,p))==null||e.abort(),h(this,p,null)};class ae{constructor(e,i){if(r(this,ht),r(this,R),r(this,vt),r(this,V),B(this,"rootNode"),B(this,"innerOptions"),r(this,d,[]),this.rootNode=typeof e=="string"?document.querySelector(e):e,!this.rootNode)throw new Error("root node not found");this.innerOptions={...Jt,...i},o(this,ht,Ot).call(this)}setIndexes(e){this.innerOptions.selectedIndexes=e;const i=[];return e.forEach((s,l)=>{n(this,d)[l]&&i.push(n(this,d)[l].setIndex(s))}),i}refreshAll(e){const i=this.rootNode.querySelectorAll(".mobile-picker-view");return i.length?(this.innerOptions.selectedIndexes.length=i.length,n(this,d).forEach(s=>s.destroy()),n(this,d).length=i.length,this.refreshColumns(n(this,d).map((s,l)=>l),e)):o(this,V,at).call(this)}refreshColumns(e,i){const s=this.rootNode.querySelectorAll(".mobile-picker-view");return s.length?(e.forEach(l=>{const a=s[l];a&&n(this,d)[l]&&(n(this,d)[l].destroy(),n(this,d)[l]=o(this,R,_t).call(this,a,i||this.innerOptions.selectedIndexes,l))}),this.innerOptions.selectedIndexes=n(this,d).map(l=>l.innerSelectedIndex),this.innerOptions.selectedIndexes):o(this,V,at).call(this)}}d=new WeakMap;ht=new WeakSet;Ot=function(t){var e,i;const s=this.rootNode.querySelectorAll(".mobile-picker-view");this.innerOptions.selectedIndexes.length=s.length,s.forEach((a,u)=>{const c=o(this,R,_t).call(this,a,t||this.innerOptions.selectedIndexes,u);n(this,d).push(c)}),this.innerOptions.selectedIndexes=n(this,d).map(a=>a.innerSelectedIndex);const l=((i=(e=n(this,d)[0])==null?void 0:e.metaInfo)==null?void 0:i.itemHeight)||0;l>0&&this.rootNode.style.setProperty("--picker-item-height",`${l}px`)};R=new WeakSet;_t=function(t,e,i){return new re(t,{...this.innerOptions,selectedIndex:e[i],onChange:(l,a)=>{o(this,vt,At).call(this,l,a,i)}})};vt=new WeakSet;At=function(t,e,i){var s,l;this.innerOptions.selectedIndexes[i]=t,(l=(s=this.innerOptions).onChange)==null||l.call(s,this.innerOptions.selectedIndexes,e,i)};V=new WeakSet;at=function(){return this.innerOptions.selectedIndexes=[],n(this,d).forEach(t=>t.destroy()),h(this,d,[]),[]};export{ae as P};
